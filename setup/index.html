


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://fruitnanny.github.com/setup/">
      
      
      <link rel="shortcut icon" href="../images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.1, mkdocs-material-5.1.6">
    
    
      
        <title>Rasberry Pi Setup - FruitNanny</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4b9ffd7b.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rasberry-pi-setup" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://fruitnanny.github.com/" title="FruitNanny" class="md-header-nav__button md-logo" aria-label="FruitNanny">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.73 15l-3.9 6.76a9.984 9.984 0 008.49-2.01l-3.66-6.35M2.46 15c.92 2.92 3.15 5.26 5.99 6.34L12.12 15m-3.58-3l-3.9-6.75A9.855 9.855 0 002 12c0 .68.07 1.35.2 2h7.49m12.11-4h-7.49l.29.5 4.76 8.25A9.93 9.93 0 0022 12c0-.69-.07-1.36-.2-2m-.26-1c-.92-2.93-3.15-5.26-5.99-6.34L11.88 9M9.4 10.5l4.77-8.26C13.47 2.09 12.75 2 12 2c-2.4 0-4.6.84-6.32 2.25l3.66 6.35.06-.1z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            FruitNanny
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Rasberry Pi Setup
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/fruitnanny/fruitnanny.github.io/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://fruitnanny.github.com/" title="FruitNanny" class="md-nav__button md-logo" aria-label="FruitNanny">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.73 15l-3.9 6.76a9.984 9.984 0 008.49-2.01l-3.66-6.35M2.46 15c.92 2.92 3.15 5.26 5.99 6.34L12.12 15m-3.58-3l-3.9-6.75A9.855 9.855 0 002 12c0 .68.07 1.35.2 2h7.49m12.11-4h-7.49l.29.5 4.76 8.25A9.93 9.93 0 0022 12c0-.69-.07-1.36-.2-2m-.26-1c-.92-2.93-3.15-5.26-5.99-6.34L11.88 9M9.4 10.5l4.77-8.26C13.47 2.09 12.75 2 12 2c-2.4 0-4.6.84-6.32 2.25l3.66 6.35.06-.1z"/></svg>

    </a>
    FruitNanny
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/fruitnanny/fruitnanny.github.io/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../crafting/" title="Crafting" class="md-nav__link">
      Crafting
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Rasberry Pi Setup
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Rasberry Pi Setup" class="md-nav__link md-nav__link--active">
      Rasberry Pi Setup
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#flash-the-raspbian" class="md-nav__link">
    Flash the Raspbian
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-ssh" class="md-nav__link">
    Enable SSH
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connect-raspberry-to-host" class="md-nav__link">
    Connect Raspberry to host
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-public-key-authentication" class="md-nav__link">
    SSH Public Key Authentication
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audio-device-setup" class="md-nav__link">
    Audio Device Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disable-bluetooth" class="md-nav__link">
    Disable Bluetooth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-dht11-kernel-driver" class="md-nav__link">
    Enable DHT11 kernel driver
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-networkmanager" class="md-nav__link">
    Install NetworkManager
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-hostname" class="md-nav__link">
    Change Hostname
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restart-the-device" class="md-nav__link">
    Restart the Device
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fruitnanny-packages" class="md-nav__link">
    FruitNanny Packages
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Development
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Development" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../development/api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../development/ui/" title="Web Interface" class="md-nav__link">
      Web Interface
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#flash-the-raspbian" class="md-nav__link">
    Flash the Raspbian
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-ssh" class="md-nav__link">
    Enable SSH
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connect-raspberry-to-host" class="md-nav__link">
    Connect Raspberry to host
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssh-public-key-authentication" class="md-nav__link">
    SSH Public Key Authentication
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audio-device-setup" class="md-nav__link">
    Audio Device Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disable-bluetooth" class="md-nav__link">
    Disable Bluetooth
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-dht11-kernel-driver" class="md-nav__link">
    Enable DHT11 kernel driver
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-networkmanager" class="md-nav__link">
    Install NetworkManager
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-hostname" class="md-nav__link">
    Change Hostname
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restart-the-device" class="md-nav__link">
    Restart the Device
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fruitnanny-packages" class="md-nav__link">
    FruitNanny Packages
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/fruitnanny/fruitnanny.github.io/edit/docs/source/setup.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="rasberry-pi-setup">Rasberry Pi Setup<a class="headerlink" href="#rasberry-pi-setup" title="Permanent link">&para;</a></h1>
<p>This section describes the software setup of Raspberry Pi. The model used for
here is a <a href="https://www.raspberrypi.org/products/raspberry-pi-3-model-b-plus/">Raspberry Pi 3+</a>.</p>
<p><img alt="Raspbian Logo" src="https://upload.wikimedia.org/wikipedia/de/c/cb/Raspberry_Pi_Logo.svg" style="max-width: 100px; margin: 0 auto; display: block;"></p>
<hr />
<h2 id="flash-the-raspbian">Flash the Raspbian<a class="headerlink" href="#flash-the-raspbian" title="Permanent link">&para;</a></h2>
<p>We use <a href="https://www.raspberrypi.org/downloads/raspbian/">Raspban Buster Lite</a>
as base version.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Download latest zipped Raspbian image. This downloads a</span>
<span class="c1"># &quot;YYYY-MM-DD-raspbian-buster-lite.zip&quot; file.</span>
curl -O <span class="k">$(</span>curl --head -sL -w %<span class="o">{</span>url_effective<span class="o">}</span> -o /dev/null https://downloads.raspberrypi.org/raspbian_lite_latest<span class="k">)</span>

<span class="c1"># Download the SHA256 checksum</span>
curl -O <span class="k">$(</span>curl --head -sL -w %<span class="o">{</span>url_effective<span class="o">}</span> -o /dev/null https://downloads.raspberrypi.org/raspbian_lite_latest<span class="k">)</span>.sha256

<span class="c1"># Verify the download</span>
sha256sum -c *-raspbian-buster-lite.zip.sha256

<span class="c1"># Unpack zipped image file</span>
unzip *-raspbian-buster-lite.zip

<span class="c1"># Clean up zip and checksum file</span>
rm -v *-raspbian-buster-lite.zip *-raspbian-buster-lite.zip.sha256
</code></pre></div>


<p>Now, insert the SD card and determine the device path. In our example this is
<code>/dev/mmcblk0</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is the SD device <code>/dev/mmcblk0</code>, not a partition on the device,
e.g. <code>/dev/mmcblk0p1</code>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Double check the device path. The following operation will destroy any
data on the output device. </p>
</div>
<div class="codehilite"><pre><span></span><code><span class="c1"># Write Raspbian image to SD card</span>
sudo dd <span class="k">if</span><span class="o">=</span><span class="k">$(</span>ls *-raspbian-buster-lite.img<span class="k">)</span> <span class="nv">of</span><span class="o">=</span>/dev/mmcblk0 <span class="nv">bs</span><span class="o">=</span>4M <span class="nv">status</span><span class="o">=</span>progress

<span class="c1"># Reload partition table of the SD card</span>
sudo partprobe /dev/mmcblk0
</code></pre></div>


<h2 id="enable-ssh">Enable SSH<a class="headerlink" href="#enable-ssh" title="Permanent link">&para;</a></h2>
<p>SSH is enabled by placing a file named <code>ssh</code> into the root directory of the
boot partition.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Mount boot partition</span>
sudo mount /dev/mmcblk0p1 /mnt/

<span class="c1"># Create &quot;ssh&quot; file to enable SSH server</span>
sudo touch /mnt/ssh

<span class="c1"># Unmount boot partition again</span>
sudo umount /mnt
</code></pre></div>


<p>The SD card is now ready to boot the Raspberry Pi.</p>
<h2 id="connect-raspberry-to-host">Connect Raspberry to host<a class="headerlink" href="#connect-raspberry-to-host" title="Permanent link">&para;</a></h2>
<p>All further commands will be executed via ssh directly on the Raspberry. For
this, the host computer needs to connect the Raspberry. There are two options:</p>
<ol>
<li>Either you have connect it with your wired local network and let the router
   assign an IP address to the Raspberry via DHCP.</li>
<li>Connect the Raspberry directly via Ethernet to the host and "share" the
   Internet connection. This can be done easily from within NetworkManager.</li>
</ol>
<p>The following command can be used to create shared connection from the
   command line.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Replace the interface name (ifname) <code>eno1</code> with the name of the ethernet
interface that will be connected to the Raspberry Pi. The interfaces can be
inspected with <code>ip addr</code>. </p>
</div>
<div class="codehilite"><pre><span></span><code><span class="c1"># Create shared Ethernet connection via NetworkManager </span>
nmcli connection add  con-name <span class="s2">&quot;Raspberry Pi&quot;</span> <span class="nb">type</span> ethernet ipv4.method shared ifname eno1 
</code></pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The IP address can queries via mDNS with the hostname <code>raspberry.local</code>.
Ensure that mDNS is available on your system, either via Avahi or
systemd-resolve.</p>
</div>
<p>After figering out the connection method, insert the SD card into the
Raspberry and boot the device.</p>
<div class="codehilite"><pre><span></span><code>ssh pi@raspberrypi.local
</code></pre></div>


<p>The default Raspbian password is <code>raspberry</code>.</p>
<h2 id="ssh-public-key-authentication">SSH Public Key Authentication<a class="headerlink" href="#ssh-public-key-authentication" title="Permanent link">&para;</a></h2>
<p>The first action will be to replace the default SSH password with proper
public key authentication. Copy your public SSH key to the Raspberry:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Executed on the host machine. Copies the public SSH key to the Raspberry</span>
ssh-copy-id pi@raspberrypi.local

<span class="c1"># Now, you can connect the the Raspberry without password</span>
ssh pi@raspberrypi.local

<span class="c1"># Executed on the Raspberry Pi. Deletes the password of the user &quot;pi&quot;.</span>
sudo passwd --delete pi
</code></pre></div>


<p>All further setup steps are performed on the Raspberry Pi.</p>
<h2 id="audio-device-setup">Audio Device Setup<a class="headerlink" href="#audio-device-setup" title="Permanent link">&para;</a></h2>
<p>The Linux audio subsystem of the WebRTC native code package searches all
available audio device. The USB microphone should be the first in this list.
For that reason, we disable the in the device tree via device tree and
rearrange the USB audio driver kernel driver load order.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Disable raspberry audio</span>
sudo sed -i <span class="s2">&quot;s/^dtparam=audio=on/# dtparam=audio=on # disabled for rpi-webrtc-streamer/&quot;</span> <span class="se">\</span>
    /boot/config.txt

<span class="c1"># Reorder USB audio device index</span>
sudo sed -i <span class="s2">&quot;s/^options snd-usb-audio index=-2/# options snd-usb-audio index=-2 # disabled for rpi-webrtc-streamer/&quot;</span> <span class="se">\</span>
    /lib/modprobe.d/aliases.conf
</code></pre></div>


<h2 id="disable-bluetooth">Disable Bluetooth<a class="headerlink" href="#disable-bluetooth" title="Permanent link">&para;</a></h2>
<p>Currently, FruitNanny does not use Bluetooth. In order to save power, we are
going to disable the Bluetooth chip via device tree and disable all related
services.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Disable Bluetooth via device tree</span>
<span class="nb">echo</span> -e <span class="s2">&quot;\n# Disable Bluetooth\ndtoverlay=pi3-disable-bt\n&quot;</span> <span class="se">\</span>
    <span class="p">|</span> sudo tee -a /boot/config.txt

<span class="c1"># Disable Bluetooth-related services</span>
sudo systemctl disable hciuart.service bluealsa.service bluetooth.service
</code></pre></div>


<h2 id="enable-dht11-kernel-driver">Enable DHT11 kernel driver<a class="headerlink" href="#enable-dht11-kernel-driver" title="Permanent link">&para;</a></h2>
<p>The Linux kernel contains a in-kernel driver for DHT11/21/22 devices. It can
be enabled via device tree.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Enable in-kernel DHT22 driver via device tree</span>
<span class="nb">echo</span> -e <span class="s2">&quot;\n# Enable DHT11/22 iio kernel driver\ndtoverlay=dht11,gpiopin=24\n&quot;</span> <span class="se">\</span>
    <span class="p">|</span> sudo tee -a /boot/config.txt
</code></pre></div>


<h2 id="install-networkmanager">Install NetworkManager<a class="headerlink" href="#install-networkmanager" title="Permanent link">&para;</a></h2>
<p>FruitNanny uses <a href="https://wiki.gnome.org/Projects/NetworkManager">NetworkManager</a>
to control the WiFi networking via its DBus interface.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Remove default Raspbian DHCP client </span>
sudo apt-get remove dhcpcd5

<span class="c1"># Install NetworkManager</span>
sudo apt-get install network-manager
</code></pre></div>


<h2 id="change-hostname">Change Hostname<a class="headerlink" href="#change-hostname" title="Permanent link">&para;</a></h2>
<p>FruitNanny web service will be available under the mDNS hostname
<code>fruitnanny.local</code>. The standard Raspbian hostname <code>raspberry</code> will be
replaced by <code>fruitnanny</code>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you prefer a different hostname, adjust it to your liking. The hostname
is not hard coded in the web UI and should work out-of-the box.</p>
</div>
<div class="codehilite"><pre><span></span><code><span class="c1"># Change hostname</span>
sudo hostnamectl set-hostname fruitnanny

<span class="c1"># Resolve new hostname to localhost</span>
<span class="nb">echo</span> -e <span class="s2">&quot;127.0.1.1\t</span><span class="k">$(</span>hostname<span class="k">)</span><span class="s2">\n&quot;</span> <span class="p">|</span> sudo tee -a /etc/hosts
</code></pre></div>


<h2 id="restart-the-device">Restart the Device<a class="headerlink" href="#restart-the-device" title="Permanent link">&para;</a></h2>
<p>Now, reboot the device for all changes to take effect. The device is available
via the hostname <code>fruitnanny.local</code> (or what ever was chosen as new hostname).</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Reboot the device</span>
sudo reboot

<span class="c1"># Connect to the device via the new hostname</span>
ssh pi@fruitnanny.local
</code></pre></div>


<p>The NetworkManager setup can be verified by running <code>nmcli</code>. You should get a
status report similar to the following:</p>
<div class="codehilite"><pre><span></span><code><span class="n">eth0</span><span class="o">:</span> <span class="n">connected</span> <span class="n">to</span> <span class="n">Wired</span> <span class="n">connection</span> <span class="mi">1</span>
        <span class="s2">&quot;Standard SMSC9512/9514&quot;</span>
        <span class="n">ethernet</span> <span class="o">(</span><span class="n">smsc95xx</span><span class="o">),</span> <span class="n">B8</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="n">EB</span><span class="o">:</span><span class="mi">1</span><span class="n">E</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="mi">64</span><span class="o">,</span> <span class="n">hw</span><span class="o">,</span> <span class="n">mtu</span> <span class="mi">1500</span>
        <span class="n">ip4</span> <span class="k">default</span>
        <span class="n">inet4</span> <span class="mf">10.42</span><span class="o">.</span><span class="mf">0.33</span><span class="o">/</span><span class="mi">24</span>
        <span class="n">route4</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>
        <span class="n">route4</span> <span class="mf">10.42</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">24</span>
        <span class="n">inet6</span> <span class="n">fe80</span><span class="o">::</span><span class="n">e425</span><span class="o">:</span><span class="mi">949</span><span class="n">f</span><span class="o">:</span><span class="n">b455</span><span class="o">:</span><span class="n">aa70</span><span class="o">/</span><span class="mi">64</span>
        <span class="n">route6</span> <span class="n">fe80</span><span class="o">::/</span><span class="mi">64</span>
        <span class="n">route6</span> <span class="n">ff00</span><span class="o">::/</span><span class="mi">8</span>

<span class="n">wlan0</span><span class="o">:</span> <span class="n">disconnected</span>
        <span class="s2">&quot;Broadcom BCM43438 combo and Bluetooth Low Energy&quot;</span>
        <span class="n">wifi</span> <span class="o">(</span><span class="n">brcmfmac</span><span class="o">),</span> <span class="mi">0</span><span class="n">A</span><span class="o">:</span><span class="mi">08</span><span class="o">:</span><span class="mi">60</span><span class="o">:</span><span class="n">BD</span><span class="o">:</span><span class="n">DB</span><span class="o">:</span><span class="mi">6</span><span class="n">A</span><span class="o">,</span> <span class="n">hw</span><span class="o">,</span> <span class="n">mtu</span> <span class="mi">1500</span>

<span class="n">lo</span><span class="o">:</span> <span class="n">unmanaged</span>
        <span class="s2">&quot;lo&quot;</span>
        <span class="n">loopback</span> <span class="o">(</span><span class="n">unknown</span><span class="o">),</span> <span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="o">,</span> <span class="n">sw</span><span class="o">,</span> <span class="n">mtu</span> <span class="mi">65536</span>

<span class="n">DNS</span> <span class="n">configuration</span><span class="o">:</span>
        <span class="n">servers</span><span class="o">:</span> <span class="mf">10.42</span><span class="o">.</span><span class="mf">0.1</span>
        <span class="kd">interface</span><span class="o">:</span> <span class="n">eth0</span>
</code></pre></div>


<h2 id="fruitnanny-packages">FruitNanny Packages<a class="headerlink" href="#fruitnanny-packages" title="Permanent link">&para;</a></h2>
<p>Finally, the FruitNanny packages will be installed. They are provided as
Debian packages and hosted as Debian package repository via GitHub Pages.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Add FruitNanny GPG key</span>
curl -sL https://fruitnanny.github.io/pubkey.gpg <span class="p">|</span> sudo apt-key add -

<span class="c1"># Add FruitNanny repository</span>
<span class="nb">echo</span> <span class="s2">&quot;deb https://fruitnanny.github.io/debian buster main&quot;</span> <span class="p">|</span> sudo tee /etc/apt/sources.list.d/fruitnanny.list

<span class="c1"># Update package index</span>
sudo apt update

<span class="c1"># Install FruitNanny packages</span>
sudo apt install fruitnanny-api
</code></pre></div>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: May 21, 2020
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../crafting/" title="Crafting" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Crafting
              </div>
            </div>
          </a>
        
        
          <a href="../development/api/" title="API" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                API
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.a0c4167b.min.js"></script>
      <script src="../assets/javascripts/bundle.fb26dd1d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>